<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generation of TDM output — out.data • TREX</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Generation of TDM output — out.data" />
<meta property="og:description" content="Generates relevant output from the sap flux density (\(SFD\)) values.
This function provides both \(F_{d}\) (\(SFD\) expressed in \(mmol~m^{-2}s^{-1}\)) and crown conductance values
(\(G_{C}\); Meinzer et al. 2013, Pappas et al. 2018, Peters et al. 2018); an analogue to stomatal conductance) in an easily exportable format.
Additionally, the function can perform environmental filtering on \(F_{d}\) and \(G_{C}\) and model \(G_{C}\) sensitivity to vapour pressure deficit (\(VPD\)).
The user can choose between in- (method = “env.filt”) or excluding (method = “stat”) environmental filtering
on the \(G_{C}\) and adjust the filter threshold manually." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TREX</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generation of TDM output</h1>
    
    <div class="hidden name"><code>out.data.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generates relevant output from the sap flux density (\(SFD\)) values.
This function provides both \(F_{d}\) (\(SFD\) expressed in \(mmol~m^{-2}s^{-1}\)) and crown conductance values
(\(G_{C}\); Meinzer <em>et al.</em> 2013, Pappas <em>et al.</em> 2018, Peters <em>et al.</em> 2018); an analogue to stomatal conductance) in an easily exportable format.
Additionally, the function can perform environmental filtering on \(F_{d}\) and \(G_{C}\) and model \(G_{C}\) sensitivity to vapour pressure deficit (\(VPD\)).
The user can choose between in- (<code>method = “env.filt”</code>) or excluding (<code>method = “stat”</code>) environmental filtering
on the \(G_{C}\) and adjust the filter threshold manually.</p>
    </div>

    <pre class="usage"><span class='fu'>out.data</span>(
  <span class='no'>input</span>,
  <span class='no'>vpd.input</span>,
  <span class='no'>sr.input</span>,
  <span class='no'>prec.input</span>,
  <span class='kw'>peak.hours</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>10</span>:<span class='fl'>14</span>),
  <span class='kw'>low.sr</span> <span class='kw'>=</span> <span class='fl'>150</span>,
  <span class='kw'>peak.sr</span> <span class='kw'>=</span> <span class='fl'>300</span>,
  <span class='kw'>vpd.cutoff</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>prec.lim</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"env.filt"</span>,
  <span class='kw'>max.quant</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>make.plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>input</th>
      <td><p>An <code><a href='is.trex.html'>is.trex</a></code>-compliant time series from <code><a href='tdm_cal.sfd.html'>tdm_cal.sfd</a></code> outputs
(e.g., <code>X$sfd.mw$sfd</code>)</p></td>
    </tr>
    <tr>
      <th>vpd.input</th>
      <td><p>An <code><a href='is.trex.html'>is.trex</a></code>-compliant object an individual series of \(VPD\) in \(kPa\) (see <code><a href='vpd.html'>vpd</a></code>).
The extent and temporal resolution should be equal to input.
Use <code><a href='dt.steps.html'>dt.steps</a></code> to correct if needed.</p></td>
    </tr>
    <tr>
      <th>sr.input</th>
      <td><p>An <code><a href='is.trex.html'>is.trex</a></code>-compliant object of an individual series of solar irradiance
(e.g. either PAR or global radiation; see <code><a href='sr.html'>sr</a></code>).
 The extent and temporal resolution should be equal to input. Use <code><a href='dt.steps.html'>dt.steps</a></code> to correct if needed.
 This data is only needed when applying the <code>“env.filt”</code> method.</p></td>
    </tr>
    <tr>
      <th>prec.input</th>
      <td><p>An <code><a href='is.trex.html'>is.trex</a></code>-compliant object of daily precipitation in \(mm~d^{-1}\) (see <code><a href='preci.html'>preci</a></code>).
The extent should be equal to input with a daily temporal resolution.
 Use <code><a href='dt.steps.html'>dt.steps</a></code> to correct if needed.
 This data is only needed when applying the <code>“env.filt”</code> method.</p></td>
    </tr>
    <tr>
      <th>peak.hours</th>
      <td><p>Numeric vector with hours which should be considered as peak-of-the-day hours
(default = <code><a href='https://rdrr.io/r/base/c.html'>c(10:14)</a></code>).
This variable is only needed when the <code>“stat”</code> method is selected.</p></td>
    </tr>
    <tr>
      <th>low.sr</th>
      <td><p>Numeric threshold value in the unit of the <code>sr.input</code> time-series (e.g., \(W~m^{-2}\))
to exclude cloudy days which impact \(G_{C}\) (default = 150  \(W~m^{-2}\)).
 This variable is only needed when the <code>“env.filt”</code> method is selected.</p></td>
    </tr>
    <tr>
      <th>peak.sr</th>
      <td><p>Numeric threshold value in the unit of the sr.input time-series (e.g.,  \(W~m^{-2}\))
to exclude hours which are not considered as peak-of-the-day hours (default = 300  \(W~m^{-2}\)).
This variable is only needed when the “<code>env.filt”</code> method is selected.</p></td>
    </tr>
    <tr>
      <th>vpd.cutoff</th>
      <td><p>Numeric threshold value in \(kPa\) for peak-of-the-day mean \(VPD\) to eliminate unrealistic
and extremely high values of \(G_{C}\) due to low \(VPD\) values or high values of \(G_{C}\) (default = 0.5 \(kPa\)).</p></td>
    </tr>
    <tr>
      <th>prec.lim</th>
      <td><p>Numeric threshold value in \(mm~d^{-1}\)  for daily precipitation to remove rainy days (default = 1 \(mm~d^{-1}\)).
This variable is only needed when <code>“env.filt”</code> method is selected.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Character string indicating whether precipitation and solar irradiance data should be used
to determined peak-of-the-day \(G_{C}\) values and filter the daily \(G_{C}\) values (“env.filt”)
 or not (“stat”; default). When <code>“env.filt”</code> is selected, <code>input</code>, <code>vpd.input</code>, <code>sr.input</code>, <code>prec.input</code>,
  <code>peak.sr</code>, <code>low.sr</code>, <code>vpd.cutoff</code> and <code>prec.lim</code> have to be provided.
  When <code>“stat”</code> is selected only <code>input</code>, <code>vpd.input</code> and <code>peak.hours</code>.</p></td>
    </tr>
    <tr>
      <th>max.quant</th>
      <td><p>Numeric, defining the quantile of the \(G_{C}\) data which should be considered as GC.max (default = 1).</p></td>
    </tr>
    <tr>
      <th>make.plot</th>
      <td><p>Logical; if <code>TRUE</code>, a plot is generated presenting the response of \(G_{C}\) to \(VPD\).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A named list of <code>data.frame</code> objects,
 containing the following items:</p>
<dl class='dl-horizontal'>
   <dt>raw</dt><dd><p>A <code>data.frame</code> containing the input data and filtered values. Columns include the timestamp [,“timestamp”]
(e.g., “2012-01-01 00:00:00”), year of the data [,“year”], day of year [,“doy”], input solar radiance data [,“sr”],
 daily average radiance data [,“sr”], input vapour pressure deficit data [,“vpd”], isolated peak-of-the-day vapour pressure
 deficit values [,“vpd.filt”], input daily precipitation [,“prec.day”], sap flux density expressed in \(mmol~m^{-2}s^{-1}\) [,“fd”],
 crown conductance expressed in \(mmol~m^{-2}s^{-1}~kPa^{-1}\) [,“gc”], and the filtered crown conductance [,“gc.filt”]</p></dd>

 <dt>peak.mean</dt><dd><p>A <code>data.frame</code> containing the daily mean crown conductance values.
 Columns include the timestamp [,“timestamp”] (e.g., “2012-01-01”), peak-of-the-day vapour pressure deficit [,“vpd.filt”],
  the filtered crown conductance \(mmol~m^{-2}s^{-1}~kPa^{-1}\) [,“gc.filt”],
   and the normalized crown conductance according
   to the maximum crown conductance [,“gc.norm”].</p></dd>

  <dt>sum.mod</dt><dd><p>A model summary object (see <code><a href='https://rdrr.io/r/base/summary.html'>summary</a>()</code>)
   of the model between \(VPD\) and \(G_{C}\).</p></dd>


   <dt>sum.mod.norm</dt><dd><p>A model summary object (see <code><a href='https://rdrr.io/r/base/summary.html'>summary</a>()</code>)
   of the model between \(VPD\) and \(G_{C}\)/\(GC.max\).</p></dd>




</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Various relevant outputs can be derived from the \(SFD\) data.
This function provides the option to recalculate \(SFD\) to \(F_{d}\) (expressed in \(mmol~m^{-2}s^{-1}\))
and crown conductance (according to Pappas <em>et al.</em> 2018).
\(G_{C}\) is estimated per unit sapwood area, where \(G_{C} = F_{d} / VPD\) (in kPa), assuming that
i) the stem hydraulic capacitance between the height of sensor and the leaves is negligible, and
ii) that the canopy is well coupled to the atmosphere. In order to reduce the effect of stem hydraulic capacitance,
peak-of-the-day \(G_{C}\) are solely considered for calculating daily average \(G_{C}\).
Peak-of-the-day conditions are defined by <code>peak.hours</code> or <code>peak.sr</code>. Moreover, to analyse the relationship between \(G_{C}\)
 and environmental measurements (e.g., \(VPD\)), the daily mean peak-of-the-day \(G_{C}\) values can be restricted to:
 i) non-cloudy days (see <code>low.sr</code>), to reduce the impact of low irradiance on \(G_{C}\),
 ii) non-rainy days (see <code>prec.lim</code>), as wet leaves are not well coupled to the atmosphere, and
 iii) daily mean peak-of-the-day \(G_{C}\) great then a threshold (see <code>vpd.cutoff</code>),
 to eliminate unrealistically high \(G_{C}\) values due to low \(F_{d}\) or \(VPD\) values (when method = <code>“env.filt”</code>).
 Moreover, the sensitivity of the daily mean peak-of-the-day \(G_{C}\) to \(VPD\) is modelled by fitting the following model:</p>
<p>$$G_{C} = \alpha + \beta VPD^{-0.5}$$</p>
<p>Besides using the raw daily mean peak-of-the-day \(G_{C}\) values, the function also applies
  a normalization where daily mean peak-of-the-day \(G_{C}\) is standardized to the maximum conductance (GC.max; see <code>max.quant</code>).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Meinzer, F. C., D. R. Woodruff, D. M. Eissenstat,
 H. S. Lin, T. S. Adams, and K. A. McCulloh. 2013. Above-and belowground controls on water use by
 trees of different wood types in an eastern US deciduous forest.
 Tree Physiology, 33(4):345–356. <a href='doi:10.1093/treephys/tpt012'>doi:10.1093/treephys/tpt012</a>.</p>
<p>Pappas, C. et al. 2018. Boreal tree hydrodynamics: asynchronous, diverging, yet complementary.
 Tree Physiololgy. 38(7):953–964. <a href='doi:10.1093/treephys/tpy043'>doi:10.1093/treephys/tpy043</a>.</p>
<p>Peters, R. L., M. Speich, C. Pappas, A. Kahmen, G. Arx, E. Graf Pannatier,
 K. Steppe, K. Treydte, A. Stritih, and P. Fonti. 2018.
 Contrasting stomatal sensitivity to temperature and soil drought in mature
 alpine conifers, Plant, Cell &amp; Environment. 42(5):1674-1689. <a href='doi:10.1111/pce.13500'>doi:10.1111/pce.13500</a>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>#Gc response function</span>
<span class='co'>#Gc response function</span>
<span class='no'>raw</span>   <span class='kw'>&lt;-</span> <span class='fu'><a href='is.trex.html'>is.trex</a></span>(<span class='fu'><a href='example.data.html'>example.data</a></span>(<span class='kw'>type</span><span class='kw'>=</span><span class='st'>"doy"</span>), <span class='kw'>tz</span><span class='kw'>=</span><span class='st'>"GMT"</span>,
                 <span class='kw'>time.format</span><span class='kw'>=</span><span class='st'>"%H:%M"</span>, <span class='kw'>solar.time</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
                 <span class='kw'>long.deg</span><span class='kw'>=</span><span class='fl'>7.7459</span>, <span class='kw'>ref.add</span><span class='kw'>=</span><span class='fl'>FALSE</span>)

<span class='no'>input</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='dt.steps.html'>dt.steps</a></span>(<span class='kw'>input</span><span class='kw'>=</span><span class='no'>raw</span>, <span class='kw'>start</span><span class='kw'>=</span><span class='st'>"2013-05-01 00:00"</span>, <span class='kw'>end</span><span class='kw'>=</span><span class='st'>"2013-11-01 00:00"</span>,
                   <span class='kw'>time.int</span><span class='kw'>=</span><span class='fl'>15</span>, <span class='kw'>max.gap</span><span class='kw'>=</span><span class='fl'>60</span>, <span class='kw'>decimals</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>df</span><span class='kw'>=</span><span class='fl'>FALSE</span>)

<span class='no'>input</span>[<span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span>(<span class='no'>input</span><span class='kw'>&lt;</span><span class='fl'>0.2</span>)]<span class='kw'>&lt;-</span> <span class='fl'>NA</span>
<span class='no'>input</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='tdm_dt.max.html'>tdm_dt.max</a></span>(<span class='no'>input</span>, <span class='kw'>methods</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"dr"</span>), <span class='kw'>det.pd</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>interpolate</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
                 <span class='kw'>max.days</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>df</span><span class='kw'>=</span><span class='fl'>FALSE</span>)

<span class='no'>output.data</span><span class='kw'>&lt;-</span> <span class='fu'><a href='tdm_cal.sfd.html'>tdm_cal.sfd</a></span>(<span class='no'>input</span>,<span class='kw'>make.plot</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>df</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>wood</span><span class='kw'>=</span><span class='st'>"Coniferous"</span>)

<span class='no'>input</span><span class='kw'>&lt;-</span> <span class='no'>output.data</span>$<span class='no'>sfd.dr</span>$<span class='no'>sfd</span>

<span class='no'>output</span><span class='kw'>&lt;-</span> <span class='fu'>out.data</span>(<span class='kw'>input</span><span class='kw'>=</span><span class='no'>input</span>, <span class='kw'>vpd.input</span><span class='kw'>=</span><span class='no'>vpd</span>, <span class='kw'>sr.input</span><span class='kw'>=</span><span class='no'>sr</span>, <span class='kw'>prec.input</span><span class='kw'>=</span><span class='no'>preci</span>,
                  <span class='kw'>low.sr</span> <span class='kw'>=</span> <span class='fl'>150</span>, <span class='kw'>peak.sr</span><span class='kw'>=</span><span class='fl'>300</span>, <span class='kw'>vpd.cutoff</span><span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>prec.lim</span><span class='kw'>=</span><span class='fl'>1</span>,
                  <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"env.filt"</span>, <span class='kw'>max.quant</span><span class='kw'>=</span><span class='fl'>0.99</span>, <span class='kw'>make.plot</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>output</span>)

}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Richard Peters, Christoforos Pappas, Alexander Hurley, Kathy Steppe.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


