<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Signal dampening correction — tdm_damp • TREX</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Signal dampening correction — tdm_damp" />
<meta property="og:description" content="When long-term \(K\) series (~3 years) are provided, one can perform
 a signal dampening correction (when no re-installation of the sensors has been applied;
 see Peters et al. 2018). For the application of the signal dampening
 correction care has to be taken in visually inspecting the correction curve
 (see make.plot = TRUE). The correction curve is constructed with
 the day since installation and the day of year (DOY) to account for seasonal changes in \(K\)
 values. The function provided corrected \(K\) values and the subsequent correction curve." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TREX</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Signal dampening correction</h1>
    
    <div class="hidden name"><code>tdm_damp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>When long-term \(K\) series (~3 years) are provided, one can perform
 a signal dampening correction (when no re-installation of the sensors has been applied;
 see Peters et al. 2018). For the application of the signal dampening
 correction care has to be taken in visually inspecting the correction curve
 (see <code>make.plot = TRUE</code>). The correction curve is constructed with
 the day since installation and the day of year (DOY) to account for seasonal changes in \(K\)
 values. The function provided corrected \(K\) values and the subsequent correction curve.</p>
    </div>

    <pre class="usage"><span class='fu'>tdm_damp</span>(<span class='no'>input</span>, <span class='kw'>k.threshold</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>make.plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>df</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>input</th>
      <td><p>An <code><a href='is.trex.html'>is.trex</a></code>-compliant object (<code>zoo</code> vector, <code>data.frame</code>) of \(K\) values containing
a timestamp and a value column.</p></td>
    </tr>
    <tr>
      <th>k.threshold</th>
      <td><p>Numeric, the threshold below which daily maximum \(K\) values should not be considered (default = 0.05).</p></td>
    </tr>
    <tr>
      <th>make.plot</th>
      <td><p>Logical; if <code>TRUE</code>, a plot is generated presenting the correction curve and the \(K\) series.</p></td>
    </tr>
    <tr>
      <th>df</th>
      <td><p>Logical; If <code>TRUE</code>, output is provided in a <code>data.frame</code> format
 with a timestamp and a value column. If <code>FALSE</code>, output
 is provided as a <code>zoo</code> vector object (default = FALSE).</p>

<p>@details The function fits a correction curve for signal dampening (e.g., due to wounding)
 according to Peters et al. (2018). A sensor specific function was fitted to daily maximum
 \(K\) values (considering a minimum cut-off threshold). Dependent variables
 for the function include seasonality (DOY) and days since installation (t).
 First, seasonal effects were removed by correcting the \(K\) series (residuals; \(Kresid\))
 to a second-order polynomial with DOY. These residuals were then used within a
 nonlinear model:
 $$K_{resid} = (a + b * t)/(1 + c * t + d * t^{2})$$</p>
<p>The fitted parameters for \(t\) (with \(a\), \(b\), \(c\) and \(d\)) were used to
 correct \(K\) and scale it to the maximum within the first year of installation.
 <strong>Note, that the stability of the fit has to be visually inspected before using the output data</strong>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>zoo</code> object or <code>data.frame</code> in the appropriate
 format for other functionalities.
 See <code><a href='tdm_dt.max.html'>tdm_dt.max</a></code> output specifications.
 All \(K\) values for each method are been provided when an <code><a href='is.trex.html'>is.trex</a></code>-object was used as input.
 If an individual time series was provided for input with \(K\) values an alternative output is given:</p>
<p></p><dl class='dl-horizontal'>
   <dt>k.cor</dt><dd><p>corrected K values according to the correction curve.</p></dd>
   <dt>k</dt><dd><p>K values provided as input.</p></dd>
   <dt>damp.mod</dt><dd><p>data.frame with the coefficients of the correction curve.</p></dd>

 
</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Peters RL, Fonti P, Frank DC, Poyatos R, Pappas C, Kahmen A, Carraro V,
Prendin AL, Schneider L, Baltzer JL, Baron-Gafford GA, Dietrich L, Heinrich I,
Minor RL, Sonnentag O, Matheny AM, Wightman MG, Steppe K. 2018.
Quantification of uncertainties in conifer sap flow measured with the thermal
dissipation method. New Phytologist 219:1283-1299 &lt;doi: 10.1111/nph.15241&gt;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
 <span class='co'>#correct for dampening of the signal</span>
<span class='no'>raw</span>   <span class='kw'>&lt;-</span>
  <span class='fu'><a href='is.trex.html'>is.trex</a></span>(
    <span class='fu'><a href='example.data.html'>example.data</a></span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"doy"</span>),
    <span class='kw'>tz</span> <span class='kw'>=</span> <span class='st'>"GMT"</span>,
    <span class='kw'>time.format</span> <span class='kw'>=</span> <span class='st'>"%H:%M"</span>,
    <span class='kw'>solar.time</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
    <span class='kw'>long.deg</span> <span class='kw'>=</span> <span class='fl'>7.7459</span>,
    <span class='kw'>ref.add</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
  )
<span class='no'>input</span> <span class='kw'>&lt;-</span>
  <span class='fu'><a href='dt.steps.html'>dt.steps</a></span>(
    <span class='kw'>input</span> <span class='kw'>=</span> <span class='no'>raw</span>,
    <span class='kw'>time.int</span> <span class='kw'>=</span> <span class='fl'>15</span>,
    <span class='kw'>max.gap</span> <span class='kw'>=</span> <span class='fl'>60</span>,
    <span class='kw'>decimals</span> <span class='kw'>=</span> <span class='fl'>6</span>,
    <span class='kw'>df</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
  )
<span class='no'>input</span>[<span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span>(<span class='no'>input</span> <span class='kw'>&lt;</span> <span class='fl'>0.2</span>)] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>
<span class='no'>input</span> <span class='kw'>&lt;-</span>
  <span class='fu'><a href='tdm_dt.max.html'>tdm_dt.max</a></span>(
    <span class='no'>input</span>,
    <span class='kw'>methods</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"pd"</span>, <span class='st'>"mw"</span>, <span class='st'>"dr"</span>),
    <span class='kw'>det.pd</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
    <span class='kw'>interpolate</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
    <span class='kw'>max.days</span> <span class='kw'>=</span> <span class='fl'>10</span>,
    <span class='kw'>df</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
  )
<span class='no'>output.data</span> <span class='kw'>&lt;-</span> <span class='fu'>tdm_damp</span>(<span class='no'>input</span>,
                    <span class='kw'>k.threshold</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
                    <span class='kw'>make.plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
                    <span class='kw'>df</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>output.data</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>output.data</span><span class='kw'>[[</span><span class='st'>"k.dr"</span>]])
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>output.data</span><span class='kw'>[[</span><span class='st'>"k.dr"</span>]], <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span>(<span class='fu'><a href='https://rdrr.io/r/grDevices/plotmath.html'>italic</a></span>(<span class='st'>"K"</span>)))
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Richard Peters, Christoforos Pappas, Alexander Hurley, Kathy Steppe.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


